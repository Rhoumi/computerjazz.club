---
layout: layouts/base.njk
---
<article class="album">
    <header class="album-header">
        {% if cover %}
        <div class="album-cover-container">
            <img src="{{ cover }}" alt="{{ title }} cover" class="album-cover">
        </div>
        {% endif %}
        <div class="album-info">
            <h1 class="album-title">{{ title }}</h1>
            {% if artists %}
                <p class="album-artists">by
                {% for artistName in artists %}
                    {% set artistSlug = artistName | slugify %}
                    <a href="/artists/{{ artistSlug }}/" class="artist-link">{{ artistName }}</a>{% if not loop.last %}{% if loop.revindex == 2 %} && {% else %}, {% endif %}{% endif %}
                {% endfor %}
                </p>
            {% elif artist %}
                <p class="album-artist">by {{ artist }}</p>
            {% endif %}

            {% if labels %}
                <p class="labels-artists">Released on
                {% for labelsName in labels %}
                    {% set labelsSlug = labelsName | slugify %}
                    <a href="/labels/{{ labelsSlug }}/" class="labels-link">{{ labelsName }}</a>{% if not loop.last %}{% if loop.revindex == 2 %} && {% else %}, {% endif %}{% endif %}
                {% endfor %}
                </p>
            {% elif labels %}
                <p class="labels-artist">Released on {{ labels }}</p>
            {% endif %}

            {% if releaseDate %}<p class="release-date">Date: {{ releaseDate | date("%B %d, %Y") }}</p>{% endif %}
            {% if genre %}
                <p class="genre">Genre:
                {% if genre is iterable and genre is not string %}
                    {{ genre | join(", ") }}
                {% else %}
                    {{ genre }}
                {% endif %}
                </p>
            {% endif %}

            {% if merch and merch.length > 0 %}
            <div class="album-shop-link">
                <a href="/shop{{ page.url | replace('/audio', '') }}" class="btn btn-secondary">View Merchandise</a>
            </div>
            {% endif %}
        </div>
    </header>

    {% if description %}
    <div class="album-description">
        {{ description | markdown | safe }}
    </div>
    {% endif %}

    {% if tracks %}
    <section class="tracklist">
        <h2>Tracks</h2>
        <ol class="tracks">
        {% for track in tracks %}
            <li class="track" data-track="{{ loop.index }}">
                <div class="track-info">
                    <span class="track-number">{{ loop.index }}.</span>
                    <span class="track-title">{{ track.title }}</span>
                    {% if track.duration %}<span class="track-duration">{{ track.duration }}</span>{% endif %}
                </div>
                {% if track.file %}
                <div class="track-controls">
                    <audio controls class="track-player" preload="metadata">
                        <source src="{{ track.file }}" type="audio/mpeg">
                        <source src="{{ track.file | replace('.mp3', '.ogg') }}" type="audio/ogg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
                {% endif %}
            </li>
        {% endfor %}
        </ol>
    </section>
    {% endif %}

    <div class="album-content">
        {{ content | safe }}
    </div>
</article>
